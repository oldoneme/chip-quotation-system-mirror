# 文档配合使用工作流程指南

## 📋 文档体系概览

项目中的.md文件形成了一个完整的工作流程体系，每个文档都有特定的作用和使用时机：

```
开始任务
    ↓
📄 CLAUDE.md (入口检查清单)
    ↓
📋 CLAUDE_WORKFLOW.md (强制性安全检查)
    ↓
📊 具体项目计划文档
    ↓
💻 代码模板参考
    ↓
✅ 执行和跟踪
```

---

## 🔄 标准工作流程

### 1️⃣ 任务开始 - CLAUDE.md (强制入口)

**何时使用**: 收到任何任务指令时
**必须完成的检查**:
- [ ] 读取 CLAUDE_WORKFLOW.md
- [ ] 确认任务类型
- [ ] 检查安全要求  
- [ ] 备份当前状态
- [ ] 创建计划 (TodoWrite)
- [ ] 开始执行

**我的自动行为**:
```python
def start_any_task():
    # 1. 自动读取 CLAUDE_WORKFLOW.md
    workflow_rules = read_workflow_rules()
    
    # 2. 自动执行安全检查
    if not pass_security_checks():
        return "停止 - 安全检查未通过"
    
    # 3. 自动检查git状态
    git_status = check_git_status()
    
    # 4. 自动创建TodoWrite计划
    create_task_plan()
    
    # 5. 确认可以开始
    return "检查完毕，可以开始执行"
```

### 2️⃣ 安全检查 - CLAUDE_WORKFLOW.md (强制执行)

**何时使用**: 每次修改代码前自动执行
**检查内容**:
- 核心文件保护 (AuthContext.js等)
- 最小变更原则
- 功能隔离验证
- Git工作流程规则

**我的自动行为**:
- 修改认证相关文件时 → 自动警告并要求确认
- 超过3个文件修改时 → 自动建议分解任务
- 检测到破坏性变更时 → 自动要求备份

### 3️⃣ 项目规划 - 具体项目文档

| 文档名称 | 使用场景 | 作用 |
|----------|----------|------|
| `WECOM_APPROVAL_DETAILED_PLAN.md` | 企业微信审批项目 | 55个详细任务分解 |
| `PROJECT_PROGRESS_TRACKER.md` | 通用项目跟踪 | 进度管理和状态更新 |
| `TASK_OPTIMIZATION_RECOMMENDATIONS.md` | 任务优化分析 | 风险评估和优化建议 |

### 4️⃣ 代码实施 - 模板参考

| 文档名称 | 使用场景 | 内容 |
|----------|----------|------|
| `CODE_TEMPLATES_REFERENCE.md` | 编写代码时 | 完整的代码实现模板 |

---

## 🤖 我的自动化工作流程

### 当您说"开始执行阶段A"时，我会：

1. **自动读取 CLAUDE.md** ✅
   ```
   检查强制性预检查清单
   ```

2. **自动读取 CLAUDE_WORKFLOW.md** ✅  
   ```
   执行安全检查和风险评估
   ```

3. **自动查询项目计划** ✅
   ```
   from WECOM_APPROVAL_DETAILED_PLAN.md 
   get 阶段A任务列表
   ```

4. **自动创建TodoWrite** ✅
   ```
   TodoWrite([
       {"task": "A1.1 补齐.env配置", "status": "pending"},
       {"task": "A1.2 创建规则配置", "status": "pending"},
       ...
   ])
   ```

5. **开始执行第一个任务** ✅
   ```
   参考 CODE_TEMPLATES_REFERENCE.md
   实施具体代码
   ```

6. **实时更新进度** ✅
   ```
   更新 WECOM_APPROVAL_DETAILED_PLAN.md 中的任务状态
   ```

### 当遇到问题时，我会：

1. **自动检查 CLAUDE_WORKFLOW.md** 
   - 是否触发高风险文件警告？
   - 是否违反最小变更原则？

2. **自动查询优化建议**
   ```
   从 TASK_OPTIMIZATION_RECOMMENDATIONS.md
   查找对应的解决方案
   ```

3. **自动提供代码模板**
   ```
   从 CODE_TEMPLATES_REFERENCE.md 
   提供相关实现参考
   ```

---

## 🎯 您的指导需求

### ✅ 我可以自动处理的场景

1. **标准任务执行**
   - "开始阶段A" → 我自动执行完整流程
   - "继续下一个任务" → 我自动查找并执行
   - "更新进度" → 我自动更新所有相关文档

2. **安全检查**
   - 自动读取工作流程文档
   - 自动执行预检查清单
   - 自动警告高风险操作

3. **代码实施**
   - 自动参考代码模板
   - 自动遵循最佳实践
   - 自动更新进度状态

### ⚠️ 需要您指导的场景

1. **战略决策**
   - "跳过某个阶段" → 需要您确认
   - "修改计划优先级" → 需要您决定
   - "处理计划外问题" → 需要您指导

2. **例外情况**
   - 遇到未预见的技术问题
   - 需要修改核心架构
   - 发现安全风险

3. **质量确认**
   - 阶段验收是否通过
   - 代码质量是否满意
   - 是否继续下一阶段

---

## 📖 实际使用示例

### 场景1: 开始新项目
```
您: "开始企业微信审批项目"

我的自动流程:
1. ✅ 读取 CLAUDE.md → 执行预检查清单
2. ✅ 读取 CLAUDE_WORKFLOW.md → 安全检查
3. ✅ 读取 WECOM_APPROVAL_DETAILED_PLAN.md → 获取任务列表  
4. ✅ 创建 TodoWrite → 第一个任务设为in_progress
5. ✅ 参考 CODE_TEMPLATES_REFERENCE.md → 开始实施
6. ✅ 实时报告进度

无需您再次指导，直接开始执行。
```

### 场景2: 遇到问题
```
我: "检测到要修改 AuthContext.js，这是高风险文件！"

自动处理:
1. ✅ CLAUDE_WORKFLOW.md → 触发警告机制
2. ✅ 询问您: "是否确认需要修改认证核心文件？"
3. ✅ 提供备选方案 (如果有)
4. ⏳ 等待您的确认再继续

需要您的决策确认。
```

### 场景3: 阶段完成
```
我: "阶段A的15个任务全部完成，验收标准检查..."

自动处理:
1. ✅ 检查 WECOM_APPROVAL_DETAILED_PLAN.md → 阶段A验收清单
2. ✅ 自动运行测试验证
3. ✅ 更新进度状态
4. ✅ 询问您: "阶段A验收通过，是否开始阶段B？"

等待您确认进入下一阶段。
```

---

## 🔧 文档维护自动化

### 我会自动维护的内容

1. **进度更新**
   - 任务完成状态 ✅/⏳/❌
   - 实际用时记录
   - 问题和解决方案

2. **状态同步**
   - TodoWrite ↔ 项目进度表
   - 里程碑达成情况
   - 验收标准检查结果

3. **文档一致性**
   - 确保所有.md文件信息同步
   - 自动更新交叉引用
   - 维护文档版本一致性

---

## 🎯 总结

**您只需要关注**:
- 🎯 战略方向和优先级决策
- ✅ 质量验收和阶段确认  
- ⚠️ 例外情况的处理指导

**我会自动处理**:
- 📋 工作流程检查和执行
- 💻 代码实施和模板参考
- 📊 进度跟踪和状态更新
- ⚠️ 安全检查和风险警告

这样既保证了工作的规范性和安全性，又提高了执行效率！